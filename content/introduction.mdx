---
title: 'Introduction'
description: 'GNU/Linux reference documentation'
---

### Finding text and files

```
grep -d recurse "text" # Find specific text in files in current directory and child directories
grep -rnw '/path/to/somewhere/' -e 'pattern' # Find all files with specific text
sed -i 's/original/new/g' file.txt # Replace especific characters/words in a file
find / -type f # Get a list of all directories and files
find / -type f | wc -l # Count the number of all directories and files

```

### Used and available space
```
df -h
du -hc *
du -shc /usr/*
```


## Configuration files

- Global: `/etc/profile`
- User: `~/.bashrc`

After making changes to file you need to reset the changes by executing following command:

```
# source /etc/profile
OR
# source ~/.bashrc
```

## Disks and System

#### How to list all disks and partitions

- `lsblk`
- `# fdisk -l`

#### How to list all devices and drivers

`lspci -v | less`

#### How to remove write protection of usb drives 

`$ sudo hdparm -r0 /dev/sdX`

#### How to find out hardware installed

- BIOS: `$ sudo dmidecode -t 0`
- Motherboard: `$ sudo dmidecode -t 2`
- Processor: `$ sudo dmidecode -t 4`
- RAM: `$ sudo dmidecode -t 17`
- Max RAM allowed: `$ sudo dmidecode -t 16`
- More info at <a href="https://www.linuxtechi.com/dmidecode-command-examples-linux/" target="_blank">https://www.linuxtechi.com/dmidecode-command-examples-linux/</a>

#### Create bootable pendrive from iso image

1. Insert pendrive in USB port
2. Check what is the USB pendrive device/partition: `sudo fdisk -l` or `lsblk`
3. Unmount the device/partition: `umount /dev/sdc1` (in my case, sdc1 is the USB pendrive device partition)
4. Create bootable pendrive: `sudo dd bs=4M if=my_iso_image.iso of=/dev/sdc status=progress oflag=sync`

In step 4, you must navigate where the iso image is before issuing the command.

#### How to create an image file for partition backup

`sudo dd if=/dev/sdb5 of=/media/cheo/TOSHIBA_HDD/Lubuntu_backup.img oflag=append conv=notrunc,sync,noerror status=progress`

The command above does the following:

- Create an image file of the **sdb5** partition and copy it into an external usb hard drive (TOSHIBA_HDD)
- You can name the backup image file as you please. I chose Lubuntu_backup.img, but you can name it as you wish. However, BE SURE to use the file extension **.img**
- `oflag=append conv=notrunc` copy the file in the hard drive without using the whole hard drive (otherwise the whole hard drive will be wiped out and all the original data in the hard drive will be lost)
- `conv=sync,noerror` prevents the operation to halt if an error occurs
- `status=progress` shows the progress of the operation

Note that if the partition to backup is 50GB, but the data in the partition is only occupies 20GB, the whole 50GB of the partition will be backed up

#### How to restore a partition with a backup image file

`sudo dd if=/media/cheo/TOSHIBA_HDD/Lubuntu_backup.img of=/dev/sdb5`

#### How to add a newly installed operating systems into GRUB2

1. If not already installed, install os-prober
2. Run: `sudo grub-mkconfig -o /boot/grub/grub.cfg` or `update-grub`

More info: <a href="https://wiki.archlinux.org/index.php/GRUB" target="_blank">https://wiki.archlinux.org/index.php/GRUB</a>

#### Edit GRUB2 boot options

Edit `/etc/default/grub` and make intended changes. Then run:

`$ sudo grub-mkconfig -o /boot/grub/grub.cfg`

#### Make a bash script executable

`$ chmod +x mybashscript.sh`

- Add an alias to the bash script: `$ gedit ~/.bashrc`

`alias <new name>='/home/<full path to script>/mybashscript.sh'`

 - Apply the changes in the system

$ `source ~/.bashrc`


### List of data recovery distros

- <a href="http://www.system-rescue-cd.org" target="_blank">System Rescue CD</a>
- <a href="https://partedmagic.com" target="_blank">Parted Magic</a> (paid subscription)

#### How create a System Rescue CD bootable USB

- **Download** the latest SystemRescueCd ISO image from the <a href="" target="_blank"></a>[download page](http://www.system-rescue-cd.org/Download/)
- `sudo mkdir -p /mnt/iso`
- `sudo mount -o loop,exec Downloads/systemrescuecd-x86-5.2.2.iso /mnt/iso`
- **Plug in your USB stick** and wait 5 seconds to allow enough time for the system to detect it
- **Unmount the USB stick** if auto-mount is enabled or if it was already mounted
- `cd /mnt/iso`
- `sudo bash ./usb_inst.sh`
- In the dialog that opens*, navigate the correct USB device with the up and down arrow keys, press space bar to select it and press enter
- `cd`
- `sudo umount /mnt/iso`

*If you are not using xterm-256color, the dialog won't open and the terminal will throw: **Error opening terminal: xterm-256color**

#### How to create a Parted Magic bootable USB

- **Download** the latest Partes Magic ISO image from the  [download page](https://partedmagic.com/downloads/)
- **Plug in your USB stick** and wait 5 seconds to allow enough time for the system to detect it
- **Unmount the USB stick** if auto-mount is enabled or if it was already mounted
- **Run** `dd if=/path/to/partedmagic.iso of=/dev/sdx` in a shell where sdx is the USB stick


#### List of disk partition command-line utilities

- fdisk
- parted
- gdisk
- cfdisk

#### List of data recovery command line tools

- ddrescue
- testdisk

#### Compress/Decompress directory

- Compress: `tar -zcvf mydir.tar.gz mydir`
- Decompress: `tar -zxvf mydir.tar.gz`


## ddrescue

**ddrescue** is a tool designed for cloning and recovering data. It copies data from one file or block device (hard disc, cdrom, etc) to another, trying to rescue the good parts first in case of read errors, to maximize the recovered data. 

To clone a faulty or dying drive, run ddrescue twice. First round, copy every block without read error and log the errors to rescue.log. 

`# ddrescue -f -n /dev/sdX /dev/sdY rescue.log`

Second round, copy only the bad blocks and try 3 times to read from the source before giving up. 

`# ddrescue -d -f -r3 /dev/sdX /dev/sdY rescue.log`

Now you can check the file system for corruption and mount the new drive. 

`# fsck -f /dev/sdY`

More info: <a href="https://wiki.archlinux.org/index.php/disk_cloning" target="_blank">https://wiki.archlinux.org/index.php/disk_cloning</a>



### Goodies

- bash-completion
- bc (CLI calculator)
- galculator (GTK+ scientific calculator)
- xfce4-screenshooter (screenshot utility)
- gnome-screenshot (screenshot utility)
- ristretto (image viewer utility)
- transmission-gtk (torrent client)
- leafpad (text editor)
- nethogs (CLI network processes monitor)
- vifm (vi type file manager)
- obs (screencasting software)
- screenkey (key press screencasting)
- sensors (CLI temperature monitoring)
- darktable (raw photo editing)
- rawtherapee (raw photo editing)
- nodejs
- gatsby-cli
- textlive-full, texmaker, latex2html, pandoc

for gatsby: `sudo chown -R $USER:$(id -gn $USER) /home/cheo/.config`



## Microsoft Windows

#### Clean and format pen drive in Windows with Diskpart (Windows 10)

1. Launch **CMD**
2. `diskpart`
3. `list disk`
4. `select Disk 2` *
5. `clean`
6. `create partition primary`

*On step 4, choose the correct disk number for your pen drive

#### Assign a letter to a drive

Sometimes, when plugging a hard drive or usb drive, Windows does not assign a letter and the drive is not shown in the Explorer. This is how to fix it:

- Launch '*Computer Management*' -\> Storage -\> Disk Management
- Look for the drive without a letter -\> Right click -\> '*Change drive letter and path*' -\> Add -\> Assign the following drive letter

#### How to create a bootable Windows 10 USB pendrive from Linux

1. Download Windows 10 from [here](https://www.microsoft.com/es-es/software-download/windows10ISO). Then follow these commands:
2. Insert USB pendrive (in this example in /dev/sdd)
3. Issue these commands:

`$ sudo add-apt-repository ppa:nilarimogard/webupd8`

`$ sudo apt update`

`$ sudo apt install woeusb`

`$ sudo woeusb --target-filesystem NTFS --device Downloads/Win10_1809Oct_English_x64.iso /dev/sdd`


### OpenSSH

- Connect to remote machine:

`$ ssh user@remote_machine_ip`

- Note: if the remote machine you used to ssh has been deleted and a new system has been installed in the same remote machine with the same user and IP address, issue this command:

`ssh-keygen -f "/home/cheo/.ssh/known_hosts" -R "192.168.1.43"`

- Generate a Key Pair:

`$ ssh-keygen`

- Copy the Public Key to remote machine:

`$ ssh-copy-id`

- How to copy a file from local to remote (from local shell):

`scp file_name user@remote_machine_ip:/home/remoteuser/`

- How to copy a file from remote to local (from local shell):

`scp user@remote_machine_ip:file_name /home/localuser/`


### LaTeX

#### Installation

`$ sudo apt install texlive-full texmaker`

Note that `texlive-full` installs all packages available for **texlive** (~5GB). You may want to install just `texlive-base` and only some other packages that you will use.

#### Tips

- Add linkable *table of content*:

`\usepackage{hyperref}`

- Add Japanese text support:

```
\usepackage{CJKutf8}
\begin{document}
\begin{CJK}{UTF8}{min}
日本語
\end{CJK}
\end{document}
```

- Add Yen currency character:

```
\def\yen\\{{\setbox0=\hbox{Y}Y\kern-.97\wd0\vbox{\hrule height.1ex
width.98\wd0\kern.33ex\hrule height.1ex width.98\wd0\kern.45ex}}}
\begin{document}
The  cost is 108\yen\\
\end{document}
```

- Auto generate **table of contents**:
  - Add the line `\tableofcontents` between `\begin{document}` and `\newpage`
  - Each section must be preceded by `\newpage`:
  - For the new changes to take affect, you must comment and uncomment `\tableofcontents`:
    1. `%\tableofcontents`
    2. Run
    3. `\tableofcontents`
    4. Run


### GRUB v2

The configuration file is `/boot/grub/grub.cfg`, but you shouldn't edit it directly. This file is generated by grub v2's [update-grub(8)](https://manpages.debian.org/buster/grub-legacy/update-grub.8.en.html), based on: 

1. The script snippets in `/etc/grub.d/ `
2. The configuration file `/etc/default/grub`

To configure GRUB "v2", you should do any or both of these: 

- edit `/etc/default/grub`, then run update-grub
- modifying the snippets in `/etc/grub.d/`

Also check the <a href="https://wiki.debian.org/Grub2" target="_blank">GRUB2</a> page for more detailed configuration instructions, ideas and suggestions. 
